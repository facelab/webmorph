<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Image Manipulations • webmorphR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Image Manipulations">
<meta property="og:description" content="webmorphR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">webmorphR</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9004</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/img-manip.html">Image Manipulations</a>
    </li>
    <li>
      <a href="../articles/web.html">Web Integration</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/facelab/webmorphR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="img-manip_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Image Manipulations</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/facelab/webmorphR/blob/master/vignettes/img-manip.Rmd"><code>vignettes/img-manip.Rmd</code></a></small>
      <div class="hidden name"><code>img-manip.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/facelab/webmorphR">webmorphR</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ************</span>
<span class="co">#&gt; Welcome to webmorphR. For support and examples visit:</span>
<span class="co">#&gt; https://facelab.github.io/webmorphR/</span>
<span class="co">#&gt; ************</span>
<span class="co">#&gt; Logged in as user 1</span>
<span class="co">#&gt; Your projects are using 25.8 Gb of 100 Gb</span>
<span class="co">#&gt; You have all permissions for project 1</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/magick/">magick</a></span><span class="op">)</span>
<span class="co">#&gt; Linking to ImageMagick 6.9.11.57</span>
<span class="co">#&gt; Enabled features: cairo, fontconfig, freetype, heic, lcms, pango, raw, rsvg, webp</span>
<span class="co">#&gt; Disabled features: fftw, ghostscript, x11</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span></code></pre></div>
<div id="load-your-images" class="section level2">
<h2 class="hasAnchor">
<a href="#load-your-images" class="anchor"></a>Load your images</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/test/"</span>, package <span class="op">=</span> <span class="st">"webmorphR"</span><span class="op">)</span>
<span class="va">stimlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_stim.html">read_stim</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span></code></pre></div>
<p>The lines are currently plotted as straight lines, but Lisa will add in the proper bezier curves soon.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">stimlist</span>, pt.plot <span class="op">=</span> <span class="cn">TRUE</span>, line.plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="img-manip_files/figure-html/unnamed-chunk-3-1.png" alt="Original Images and Templates" width="100%"><p class="caption">
Original Images and Templates
</p>
</div>
</div>
<div id="delete-some-points" class="section level2">
<h2 class="hasAnchor">
<a href="#delete-some-points" class="anchor"></a>Delete some points</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">remove_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/frl_features.html">frl_features</a></span><span class="op">(</span><span class="st">"imprecise"</span><span class="op">)</span>
<span class="va">stimlist</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/pt_delete.html">pt_delete</a></span><span class="op">(</span><span class="va">remove_points</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>img.plot <span class="op">=</span> <span class="cn">FALSE</span>,
       pt.plot <span class="op">=</span> <span class="cn">TRUE</span>,
       pt.shape <span class="op">=</span> <span class="st">"index"</span>, 
       pt.colour <span class="op">=</span> <span class="st">"black"</span>, 
       line.plot <span class="op">=</span> <span class="cn">TRUE</span>, 
       line.colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span>,
       border.width <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="img-manip_files/figure-html/unnamed-chunk-4-1.png" alt="Point removal" width="100%"><p class="caption">
Point removal
</p>
</div>
</div>
<div id="resize" class="section level2">
<h2 class="hasAnchor">
<a href="#resize" class="anchor"></a>Resize</h2>
<p>Resizing your images at the start of a chain can make everything go faster if you’re working with very large images, but can make them blurry if you make them too small.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stimlist</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/resize.html">resize</a></span><span class="op">(</span><span class="fl">.1</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="img-manip_files/figure-html/resize-1.png" alt="Resized Images" width="100%"><p class="caption">
Resized Images
</p>
</div>
</div>
<div id="rotate" class="section level2">
<h2 class="hasAnchor">
<a href="#rotate" class="anchor"></a>Rotate</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stimlist</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rotate.html">rotate</a></span><span class="op">(</span><span class="fl">45</span>, patch <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>pt.plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="img-manip_files/figure-html/rotate-1.png" alt="Rotated Images and Templates" width="100%"><p class="caption">
Rotated Images and Templates
</p>
</div>
</div>
<div id="crop" class="section level2">
<h2 class="hasAnchor">
<a href="#crop" class="anchor"></a>Crop</h2>
<p>You can set the new width, height, x-offset and y-offset in pixels (must be &gt; 2) or proportions.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stimlist</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/crop.html">crop</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.6</span>, height <span class="op">=</span> <span class="fl">.8</span>, 
       x_off <span class="op">=</span> <span class="fl">.2</span>, y_off <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>pt.plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="img-manip_files/figure-html/crop-1.png" alt="Cropped Images and Templates" width="100%"><p class="caption">
Cropped Images and Templates
</p>
</div>
<p>Negative offsets or widths larger than the image dimensions add a margin. You can set the colour with <code>fill</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stimlist</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/crop.html">crop</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1.2</span>, height <span class="op">=</span> <span class="fl">1.2</span>, 
       fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dodgerblue"</span>, <span class="st">"hotpink"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="img-manip_files/figure-html/crop-neg-1.png" alt="Cropped Images and Templates" width="100%"><p class="caption">
Cropped Images and Templates
</p>
</div>
<p>Or you can use the <code>patch</code> function to get the median colour from a patch of the image. If you set <code>patch</code> to <code>TRUE</code>, this will default to the top left 10 pixel square, or you can set the boundaries of the patch manually.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stimlist</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/crop.html">crop</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1.2</span>, height <span class="op">=</span> <span class="fl">1.2</span>, 
       x_off <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span>, y_off <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span>,
       patch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>x1<span class="op">=</span><span class="fl">1</span>, x2<span class="op">=</span><span class="fl">338</span>, y1<span class="op">=</span><span class="fl">1</span>, y2<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="img-manip_files/figure-html/crop-match-1.png" alt="Cropped Images with Matched Background" width="100%"><p class="caption">
Cropped Images with Matched Background
</p>
</div>
<p>You can use the <code><a href="../reference/bounds.html">bounds()</a></code> function to get the minimum and maximum x- and y-values from a list of templates, then use that to set the cropping. In the example below, the images are cropped so there is 100 pixels of padding around the boundaries, calculated across all images.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lisa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/faces.html">faces</a></span><span class="op">(</span><span class="st">"lisa"</span><span class="op">)</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bounds.html">bounds</a></span><span class="op">(</span><span class="va">lisa</span><span class="op">)</span>
<span class="va">padding</span> <span class="op">&lt;-</span> <span class="fl">100</span>

<span class="va">lisa</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/crop.html">crop</a></span><span class="op">(</span>width <span class="op">=</span> <span class="va">b</span><span class="op">$</span><span class="va">max_x</span> <span class="op">-</span> <span class="va">b</span><span class="op">$</span><span class="va">min_x</span> <span class="op">+</span> <span class="va">padding</span><span class="op">*</span><span class="fl">2</span>,
       height <span class="op">=</span> <span class="va">b</span><span class="op">$</span><span class="va">max_y</span> <span class="op">-</span> <span class="va">b</span><span class="op">$</span><span class="va">min_y</span> <span class="op">+</span> <span class="va">padding</span><span class="op">*</span><span class="fl">2</span>,
       x_off <span class="op">=</span> <span class="va">b</span><span class="op">$</span><span class="va">min_x</span> <span class="op">-</span> <span class="va">padding</span>,
       y_off <span class="op">=</span> <span class="va">b</span><span class="op">$</span><span class="va">min_y</span> <span class="op">-</span> <span class="va">padding</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>pt.plot <span class="op">=</span> <span class="cn">TRUE</span>, labels <span class="op">=</span> <span class="st">""</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="img-manip_files/figure-html/bounds-1.png" width="100%"></p>
<p>Set <code>each</code> to TRUE to calculate the boundaries separately for each template in the list instead of the full set.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bounds.html">bounds</a></span><span class="op">(</span><span class="va">lisa</span>, each <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">padding</span> <span class="op">&lt;-</span> <span class="fl">20</span>

<span class="va">lisa</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/crop.html">crop</a></span><span class="op">(</span>width <span class="op">=</span> <span class="va">b</span><span class="op">$</span><span class="va">max_x</span> <span class="op">-</span> <span class="va">b</span><span class="op">$</span><span class="va">min_x</span> <span class="op">+</span> <span class="va">padding</span><span class="op">*</span><span class="fl">2</span>,
       height <span class="op">=</span> <span class="va">b</span><span class="op">$</span><span class="va">max_y</span> <span class="op">-</span> <span class="va">b</span><span class="op">$</span><span class="va">min_y</span> <span class="op">+</span> <span class="va">padding</span><span class="op">*</span><span class="fl">2</span>,
       x_off <span class="op">=</span> <span class="va">b</span><span class="op">$</span><span class="va">min_x</span> <span class="op">-</span> <span class="va">padding</span>,
       y_off <span class="op">=</span> <span class="va">b</span><span class="op">$</span><span class="va">min_y</span> <span class="op">-</span> <span class="va">padding</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>pt.plot <span class="op">=</span> <span class="cn">TRUE</span>, labels <span class="op">=</span> <span class="st">""</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="img-manip_files/figure-html/bounds-each-1.png" width="100%"></p>
</div>
<div id="align" class="section level2">
<h2 class="hasAnchor">
<a href="#align" class="anchor"></a>Align</h2>
<p>You can align a set of images on two points. By default, these are the first two points in the template, which correspond to the left and right eye in the standard FRL template.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stimlist</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/align.html">align</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fl">350</span>, y1 <span class="op">=</span> <span class="fl">350</span>, x2 <span class="op">=</span> <span class="fl">450</span>, y2 <span class="op">=</span> <span class="fl">450</span>,
        width <span class="op">=</span> <span class="fl">800</span>, height <span class="op">=</span> <span class="fl">800</span>, fill <span class="op">=</span> <span class="st">"grey80"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>pt.plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="img-manip_files/figure-html/align-1.png" width="100%"></p>
<p>If you have a set of misaligned images and don’t fill in coordinates or dimensions, <code><a href="../reference/align.html">align()</a></code> will align to the coordinates and dimensions for the first image. The images below use the Face++ template (they were auto-delineated on webmorph), so points 63 and 81 are the eye points.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/align.html">align</a></span><span class="op">(</span><span class="va">lisa</span>, pt1 <span class="op">=</span> <span class="fl">63</span>, pt2 <span class="op">=</span> <span class="fl">81</span>, fill <span class="op">=</span> <span class="st">"grey80"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="img-manip_files/figure-html/realign1-1.png" width="100%"></p>
<p>Or you can specify the reference image by index or name.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/align.html">align</a></span><span class="op">(</span><span class="va">lisa</span>, pt1 <span class="op">=</span> <span class="fl">63</span>, pt2 <span class="op">=</span> <span class="fl">81</span>, 
      ref_img <span class="op">=</span> <span class="st">"lisa3"</span>, patch <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="img-manip_files/figure-html/realign2-1.png" width="100%"></p>
</div>
<div id="procrustes-align" class="section level2">
<h2 class="hasAnchor">
<a href="#procrustes-align" class="anchor"></a>Procrustes Align</h2>
<p>You can set the <code>procrustes</code> argument to TRUE to procrustes-align the images and templates.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">orig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lisa</span>, pt.plot <span class="op">=</span> <span class="cn">TRUE</span>, 
             labels <span class="op">=</span> <span class="st">""</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="co"># any two points that are standard on the image</span>
<span class="co"># should work for procrustes alignment</span>
<span class="va">lisa_proc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/align.html">align</a></span><span class="op">(</span><span class="va">lisa</span>, pt1 <span class="op">=</span> <span class="fl">63</span>, pt2 <span class="op">=</span> <span class="fl">81</span>,
                      procrustes <span class="op">=</span> <span class="cn">TRUE</span>, patch <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">procr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lisa_proc</span>, pt.plot <span class="op">=</span> <span class="cn">TRUE</span>, 
              labels <span class="op">=</span> <span class="st">""</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">orig</span>, <span class="va">procr</span>, nrow <span class="op">=</span> <span class="fl">2</span>, 
                   labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"original"</span>, <span class="st">"procrustes-aligned"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="img-manip_files/figure-html/procrustes-1.png" width="100%"></p>
<p>Currently, <a href="https://webmorph.org">webmorph</a> does not have this capability, but you can download your images and tems, procrustes align them with the R package, save the images and templates, and upload them back to webmorph.</p>
</div>
<div id="chaining" class="section level2">
<h2 class="hasAnchor">
<a href="#chaining" class="anchor"></a>Chaining</h2>
<p>You can also chain image manipulation commands.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stimlist</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rotate.html">rotate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">45</span>, <span class="op">-</span><span class="fl">45</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/crop.html">crop</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.5</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/crop.html">crop</a></span><span class="op">(</span><span class="fl">1.1</span>, <span class="fl">1.1</span>, fill <span class="op">=</span> <span class="st">"dodgerblue"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="img-manip_files/figure-html/chain-1.png" alt="Manipulated Images and Templates" width="100%"><p class="caption">
Manipulated Images and Templates
</p>
</div>
</div>
<div id="repeating-images" class="section level2">
<h2 class="hasAnchor">
<a href="#repeating-images" class="anchor"></a>Repeating images</h2>
<p>You can use <code><a href="https://rdrr.io/r/base/rep.html">rep()</a></code> to repeat images in a stimlist. Here, we repeat the faces 3 times each, apply 6 different rotations with different background colours, crop them to the same size, and plot them with 6 different template point colours.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">rainbow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>pink <span class="op">=</span> <span class="st">"#983E82"</span>,
             orange <span class="op">=</span> <span class="st">"#E2A458"</span>,
             yellow <span class="op">=</span> <span class="st">"#F5DC70"</span>,
             green <span class="op">=</span> <span class="st">"#59935B"</span>,
             blue <span class="op">=</span> <span class="st">"#467AAC"</span>,
             purple <span class="op">=</span> <span class="st">"#61589C"</span><span class="op">)</span>

<span class="va">stimlist</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span>each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rotate.html">rotate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">60</span>, <span class="fl">10</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">rainbow</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/crop.html">crop</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">500</span>, fill <span class="op">=</span> <span class="va">rainbow</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>pt.plot <span class="op">=</span> <span class="cn">TRUE</span>, pt.color <span class="op">=</span> <span class="va">rainbow</span>, pt.size <span class="op">=</span> <span class="fl">0.25</span>, labels <span class="op">=</span> <span class="st">""</span><span class="op">)</span></code></pre></div>
<p><img src="img-manip_files/figure-html/rep-1.png" width="100%"></p>
</div>
<div id="fun-things" class="section level2">
<h2 class="hasAnchor">
<a href="#fun-things" class="anchor"></a>Fun things</h2>
<p>You can do some more fun things to the images (but not templates) with the {magick} package that is installed with {webmorph}.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">image</span> <span class="op">&lt;-</span> <span class="va">stimlist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">img</span>

<span class="va">imglist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  <span class="fu">magick</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/magick/reference/effects.html">image_blur</a></span><span class="op">(</span><span class="va">image</span>, radius <span class="op">=</span> <span class="fl">10</span>, sigma <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,
  <span class="fu">magick</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/magick/reference/effects.html">image_charcoal</a></span><span class="op">(</span><span class="va">image</span>, radius <span class="op">=</span> <span class="fl">5</span>, sigma <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,
  <span class="fu">magick</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/magick/reference/effects.html">image_oilpaint</a></span><span class="op">(</span><span class="va">image</span>, radius <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,
  <span class="fu">magick</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/magick/reference/effects.html">image_implode</a></span><span class="op">(</span><span class="va">image</span>, factor <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>,
  <span class="fu">magick</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/magick/reference/effects.html">image_implode</a></span><span class="op">(</span><span class="va">image</span>, factor <span class="op">=</span> <span class="op">-</span><span class="fl">0.25</span><span class="op">)</span>,
  <span class="fu">magick</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/magick/reference/effects.html">image_negate</a></span><span class="op">(</span><span class="va">image</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">labs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Blur"</span>, <span class="st">"Charcoal"</span>, <span class="st">"Oilpaint"</span>, 
          <span class="st">"Implode"</span>, <span class="st">"Explode"</span>, <span class="st">"Negate"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">imglist</span>, <span class="fu">magick</span><span class="fu">::</span><span class="va"><a href="https://docs.ropensci.org/magick/reference/image_ggplot.html">image_ggplot</a></span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">.</span>, nrow <span class="op">=</span> <span class="fl">2</span>,
                     labels <span class="op">=</span> <span class="va">labs</span><span class="op">)</span></code></pre></div>
<p><img src="img-manip_files/figure-html/fun-1.png" width="100%"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Lisa DeBruine.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
