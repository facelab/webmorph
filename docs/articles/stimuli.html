<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Making Stimuli • webmorphR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Making Stimuli">
<meta property="og:description" content="webmorphR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">webmorphR</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9004</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/img-manip.html">Image Manipulations</a>
    </li>
    <li>
      <a href="../articles/web.html">Web Integration</a>
    </li>
    <li>
      <a href="../articles/stimuli.html">Making Stimuli</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/facelab/webmorphR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="stimuli_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Making Stimuli</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/facelab/webmorphR/blob/master/vignettes/stimuli.Rmd"><code>vignettes/stimuli.Rmd</code></a></small>
      <div class="hidden name"><code>stimuli.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/facelab/webmorphR">webmorphR</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ************</span>
<span class="co">#&gt; Welcome to webmorphR. For support and examples visit:</span>
<span class="co">#&gt; https://facelab.github.io/webmorphR/</span>
<span class="co">#&gt; ************</span>
<span class="co">#&gt; Logged in as user 1</span>
<span class="co">#&gt; Your projects are using 25 Gb of 100 Gb</span>
<span class="co">#&gt; You have all permissions for project 1</span></code></pre></div>
<p>This vignette will show some recipes for common types of stimulus creation.</p>
<div id="sexual-dimorphism" class="section level2">
<h2 class="hasAnchor">
<a href="#sexual-dimorphism" class="anchor"></a>Sexual Dimorphism</h2>
<p>Let’s start with a set of images from the built-in image sets.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/faces.html">faces</a></span><span class="op">(</span><span class="st">"london"</span>, pattern <span class="op">=</span> <span class="st">"(025|062|099|126|129)"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/resize.html">resize</a></span><span class="op">(</span><span class="fl">.5</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">subset</span>, nrow <span class="op">=</span> <span class="fl">1</span>,
     save <span class="op">=</span> <span class="st">"fig/subset.jpg"</span>, fig.width <span class="op">=</span> <span class="fl">10</span>, fig.height <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="fig/subset.jpg" width="100%"></p>
<p>Let’s align the images using Procrustes normalisation to the position of the first image. They need to have templates fitted to do this. The argument <code>patch = TRUE</code> tries to match the background colour as closely as possible.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">normalised</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/align.html">align</a></span><span class="op">(</span><span class="va">subset</span>, patch <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">normalised</span>, nrow <span class="op">=</span> <span class="fl">1</span>,
     save <span class="op">=</span> <span class="st">"fig/norm.jpg"</span>, fig.width <span class="op">=</span> <span class="fl">10</span>, fig.height <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="fig/norm.jpg" width="100%"></p>
<p>Now we can make an average version of these faces. This uses the morphing functions available on the web app, so you need to have a webmorph account.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">avg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeAvg.html">makeAvg</a></span><span class="op">(</span><span class="va">normalised</span><span class="op">)</span>
<span class="co">#&gt; Starting Upload...</span>
<span class="co">#&gt; ... 10 of 10 uploaded</span>
<span class="co">#&gt; Starting Deletion...</span>
<span class="co">#&gt; ... 10 of 10 deleted</span></code></pre></div>
<p>Alternatively, you can upload the files to your default project and then make the average from the uploaded files. This is best if you’ll be making more than one average or transform with them, so you don’t have to upload to the temporary directory every time.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wm_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fileUpload.html">fileUpload</a></span><span class="op">(</span><span class="va">normalised</span>, <span class="st">"/newfolder/"</span><span class="op">)</span>
<span class="va">avg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeAvg.html">makeAvg</a></span><span class="op">(</span><span class="va">wm_files</span><span class="op">)</span></code></pre></div>
<p>If you set the arguments save, fig.width, and fig.height to <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code>, the plot will save and display using <code><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">knitr::include_graphics()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">avg</span>, pt.plot <span class="op">=</span> <span class="cn">TRUE</span>, line.plot <span class="op">=</span> <span class="cn">TRUE</span>, 
     labels <span class="op">=</span> <span class="st">"Average Face"</span>, label_y <span class="op">=</span> <span class="fl">0.05</span>, label_size <span class="op">=</span> <span class="fl">8</span>,
     save <span class="op">=</span> <span class="st">"fig/avg.jpg"</span>, fig.width <span class="op">=</span> <span class="fl">6</span>, fig.height <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></code></pre></div>
<p><img src="fig/avg.jpg" width="50%"></p>
<p>You can use this average face to transform the individual faces in distinctiveness and averageness.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">avgdist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeTrans.html">makeTrans</a></span><span class="op">(</span>trans_img <span class="op">=</span> <span class="va">normalised</span>,
                     from_img <span class="op">=</span> <span class="va">normalised</span>,
                     to_img <span class="op">=</span> <span class="va">avg</span>,
                     shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Starting Upload...</span>
<span class="co">#&gt; ... 10 of 10 uploaded</span>
<span class="co">#&gt; Starting Upload...</span>
<span class="co">#&gt; ... 10 of 10 uploaded</span>
<span class="co">#&gt; Starting Upload...</span>
<span class="co">#&gt; ... 2 of 2 uploaded</span>
<span class="co">#&gt; Starting 10 Transforms...</span>
<span class="co">#&gt; ... Transforms Completed</span>
<span class="co">#&gt; Starting Deletion...</span>
<span class="co">#&gt; ... 2 of 2 deleted</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"More Distinctive"</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>,
         <span class="st">"Original              "</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>,
         <span class="st">"More Average   "</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">avgdist</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="va">normalised</span>, <span class="va">avgdist</span><span class="op">[</span><span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">lab</span>, nrow <span class="op">=</span> <span class="fl">3</span>, label_x <span class="op">=</span> <span class="fl">.4</span>, label_y <span class="op">=</span> <span class="fl">.92</span>,
       save <span class="op">=</span> <span class="st">"fig/avgtrans.jpg"</span>, fig.width <span class="op">=</span> <span class="fl">10</span>, fig.height <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></code></pre></div>
<p><img src="fig/avgtrans.jpg" width="100%"></p>
<p>Now you can rename and save your individual stimuli in a directory to use in studies.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">orig_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">subset</span><span class="op">)</span>

<span class="va">norm</span> <span class="op">&lt;-</span> <span class="va">normalised</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rename.html">rename</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"_03"</span>, replacement <span class="op">=</span> <span class="st">""</span>, prefix <span class="op">=</span> <span class="st">"norm_"</span><span class="op">)</span>

<span class="va">trans</span> <span class="op">&lt;-</span> <span class="va">avgdist</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rename.html">rename</a></span><span class="op">(</span>new_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">orig_names</span>, <span class="fl">2</span><span class="op">)</span>, 
         pattern <span class="op">=</span> <span class="st">"_03"</span>, replacement <span class="op">=</span> <span class="st">""</span>,
         prefix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dist_"</span>, <span class="st">"avg_"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="../reference/write_stim.html">write_stim</a></span><span class="op">(</span><span class="va">norm</span>, <span class="st">"stimuli"</span><span class="op">)</span>
<span class="fu"><a href="../reference/write_stim.html">write_stim</a></span><span class="op">(</span><span class="va">trans</span>, <span class="st">"stimuli"</span><span class="op">)</span></code></pre></div>
<p>This script took 1.1 minutes to render all the included images from scratch.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Lisa DeBruine.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
